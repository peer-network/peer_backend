{
	"info": {
		"_postman_id": "2b54becf-d9d4-4910-806f-40b97f4fc438",
		"name": "002_posts_wallet_graphql",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "43606001",
		"_collection_link": "https://automated-testing-with-taso.postman.co/workspace/Peer-Workspace~a910b484-5e62-449c-9ff4-504470bc690f/collection/43606001-2b54becf-d9d4-4910-806f-40b97f4fc438?action=share&source=collection_link&creator=43606001"
	},
	"item": [
		{
			"name": "Hello",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Null is in there\", function () {",
							"    let responseJson = pm.response.json();",
							"    pm.expect(responseJson.data.hello.currentuserid).to.eql(\"\");",
							"});",
							"",
							"pm.test(\"Save companyAccountId as referralUuid\", function () {",
							"    const response = pm.response.json();",
							"    const id = response.data?.hello?.companyAccountId;",
							"",
							"    pm.expect(id, \"companyAccountId should exist\").to.be.a(\"string\").that.is.not.empty;",
							"",
							"    pm.environment.set(\"referralUuid\", id);",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Hello {\n    hello {\n        currentuserid\n        currentVersion\n        wikiLink\n        lastMergedPullRequestNumber\n        companyAccountId\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Registration",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10601\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"pm.environment.set(\"userid\", response.data.register.userid);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// generate random email",
							"let randomEmail = `user_${Math.floor(Math.random() * 1000000)}@example.com`;",
							"",
							"// save",
							"pm.environment.set(\"random_email\", randomEmail);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation {\n  register(input: {\n    email: \"{{random_email}}\",\n    password: \"{{password}}\",\n    username: \"{{username}}\",\n    referralUuid: \"{{w_userid_t2}}\"\n  }) {\n    meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    userid\n  }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Verification",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10701\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation VerifiedAccount {\n    verifyAccount(userid: \"{{userid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Login tester 3",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10801\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"accessToken\", response.data.login.accessToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"refreshToken\", response.data.login.refreshToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"let token = pm.environment.get(\"accessToken\");",
							"pm.test(\"Access token exists\", function () {",
							"    pm.expect(token).to.be.a(\"string\");",
							"});",
							"",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation {\n  login(email: \"{{w_email_t3}}\",\n    password: \"{{w_password_t3}}\"\n  ) {\n    meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    accessToken\n    refreshToken\n  }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let liquidity = response.data.balance.currentliquidity;",
							"pm.environment.set(\"liquidity1\", liquidity);",
							"console.log(\"Saved liquidity:\", liquidity);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "W Login tester 2",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10801\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"accessToken\", response.data.login.accessToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"refreshToken\", response.data.login.refreshToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"let token = pm.environment.get(\"accessToken\");",
							"pm.test(\"Access token exists\", function () {",
							"    pm.expect(token).to.be.a(\"string\");",
							"});",
							"",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation {\n  login(email: \"{{w_email_t2}}\",\n    password: \"{{w_password_t2}}\"\n  ) {\n    meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    accessToken\n    refreshToken\n  }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let liquidity = response.data.balance.currentliquidity;",
							"pm.environment.set(\"liquidity\", liquidity);",
							"console.log(\"Saved liquidity:\", liquidity);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post photo",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    const responseText = pm.response.text();",
							"    pm.expect(",
							"        responseText.includes(\"11513\") || responseText.includes(\"11508\")",
							"    ).to.be.true;",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							"",
							"let postResponseCode = \"\";",
							"try {",
							"    postResponseCode = postResponse?.data?.createPost?.ResponseCode || \"\";",
							"} catch (err) {",
							"    console.log(\"Couldn't access ResponseCode:\", err);",
							"}",
							"",
							"if (postResponseCode === \"11513\") {",
							"    pm.environment.set(\"isDailyFreePost\", \"true\");",
							"    console.log(\"This was a Daily Free Post (code 11513).\");",
							"} else {",
							"    pm.environment.unset(\"isDailyFreePost\");",
							"    console.log(\"Not a Daily Free Post (code not 11513).\");",
							"}",
							"",
							"pm.test(\"All uploaded image resolutions are correct\", function () {",
							"    try {",
							"        const expectedResolutions = [\"200x300\", \"736x413\", \"225x225\"];",
							"        const mediaString = postResponse?.data?.createPost?.affectedRows?.media;",
							"        const mediaArray = JSON.parse(mediaString);",
							"",
							"        pm.expect(mediaArray.length, \"Expected 3 media items\").to.eql(3);",
							"",
							"        for (let i = 0; i < expectedResolutions.length; i++) {",
							"            const actual = mediaArray[i]?.options?.resolution;",
							"            const expected = expectedResolutions[i];",
							"",
							"            pm.expect(actual, `Media[${i}] resolution should be ${expected}`).to.eql(expected);",
							"        }",
							"    } catch (err) {",
							"        console.error(\"Error validating media resolutions:\", err);",
							"        throw new Error(\"Failed to validate media resolutions.\");",
							"    }",
							"});",
							"",
							"pm.test(\"Save (createdat + 1 day) as startday\", function () {",
							"    const createdAt = pm.response.json()?.data?.createPost?.affectedRows?.createdat;",
							"",
							"    pm.expect(createdAt, \"createdat should exist\").to.be.a(\"string\").that.is.not.empty;",
							"",
							"    const date = new Date(createdAt);",
							"    date.setDate(date.getDate() + 1);",
							"",
							"    const yyyy = date.getFullYear();",
							"    const mm = String(date.getMonth() + 1).padStart(2, \"0\");",
							"    const dd = String(date.getDate()).padStart(2, \"0\");",
							"",
							"    const nextDay = `${yyyy}-${mm}-${dd}`;",
							"",
							"    pm.environment.set(\"startday\", nextDay);",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(action: POST, input: { title: \"ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€\", mediadescription: \"ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€\", contenttype: image, media: [\"{{new_profile_pic}}\", \"{{base64_photo1}}\",\"{{base64_photo2}}\"], tags: [\"{{Camelcasetag}}\", \"{{Lowercasetag}}\", \"{{Uppercasetag}}\"]  },) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Listposts (confirm tags)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"All tags for created post are lowercase\", function () {",
							"    let body;",
							"",
							"    try {",
							"        body = pm.response.json();",
							"    } catch (e) {",
							"        throw new Error(\"Response is not valid JSON\");",
							"    }",
							"",
							"    const listPosts = body?.data?.listPosts;",
							"    const posts = listPosts?.affectedRows;",
							"",
							"    pm.expect(posts, \"listPosts.affectedRows should exist\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    const postId = pm.environment.get(\"postid\");",
							"    pm.expect(postId, \"Environment variable 'postid' must be set\").to.exist;",
							"",
							"    const targetPost = posts.find(p => String(p.id) === String(postId));",
							"    pm.expect(targetPost, `Post with id ${postId} should be present in response`).to.exist;",
							"",
							"    const tags = targetPost.tags;",
							"    pm.expect(tags, \"tags should be an array\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    tags.forEach(tag => {",
							"        pm.expect(tag, `Tag \"${tag}\" should be lowercase`).to.equal(tag.toLowerCase());",
							"    });",
							"",
							"    console.log(\"Tags for post\", postId, \":\", tags);",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        status\n        counter\n        ResponseCode\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            visibilityStatus\n            isHiddenForUsers\n            hasActiveReports\n            amountreports\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            url\n            user {\n                id\n                username\n                slug\n                img\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                isfollowed\n                isfollowing\n                isreported\n                isfriend\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                amountlikes\n                amountreplies\n                amountreports\n                isreported\n                isliked\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    visibilityStatus\n                    isHiddenForUsers\n                    hasActiveReports\n                    isfollowed\n                    isfollowing\n                    isreported\n                    isfriend\n                }\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check if order is correct",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse JSON:\", err);",
							"}",
							"",
							"const post = response?.data?.listPosts?.affectedRows?.[0];",
							"",
							"if (!post || !post.media) {",
							"    console.log(\"No post or media found in response.\");",
							"} else {",
							"    let mediaList = [];",
							"    try {",
							"        mediaList = JSON.parse(post.media);",
							"    } catch (err) {",
							"        console.log(\"Failed to parse media JSON:\", err);",
							"    }",
							"",
							"    if (mediaList.length > 0) {",
							"        // Extract width from resolution",
							"        const widths = mediaList.map(item => {",
							"            const resMatch = item.options.resolution.match(/^(\\d+)x(\\d+)$/);",
							"            if (resMatch) {",
							"                return parseInt(resMatch[1], 10); // only width",
							"            } else {",
							"                return 0;",
							"            }",
							"        });",
							"",
							"        const expectedOrder = [200, 736, 225]; // hardcoded expected widths from your response",
							"",
							"        let isOrderCorrect = true;",
							"        if (widths.length !== expectedOrder.length) {",
							"            isOrderCorrect = false;",
							"            console.log(`Width count mismatch: expected ${expectedOrder.length}, got ${widths.length}`);",
							"        } else {",
							"            for (let i = 0; i < widths.length; i++) {",
							"                if (widths[i] !== expectedOrder[i]) {",
							"                    isOrderCorrect = false;",
							"                    console.log(`Mismatch at index ${i}: expected ${expectedOrder[i]}, got ${widths[i]}`);",
							"                    break;",
							"                }",
							"            }",
							"        }",
							"",
							"        pm.test(\"Media widths are in the expected order\", function () {",
							"            pm.expect(isOrderCorrect).to.be.true;",
							"        });",
							"    } else {",
							"        console.log(\"Media list is empty.\");",
							"        pm.test(\"Media list should not be empty\", function () {",
							"            pm.expect(mediaList.length).to.be.above(0);",
							"        });",
							"    }",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response?.data?.balance?.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"let isDailyFreePost = pm.environment.get(\"isDailyFreePost\");",
							"",
							"console.log(`ðŸ’° Old Liquidity: ${oldLiquidity}`);",
							"console.log(`ðŸ’° New Liquidity: ${newLiquidity}`);",
							"console.log(`ðŸ†“ isDailyFreePost exists?: ${isDailyFreePost !== undefined}`);",
							"",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"",
							"if (isDailyFreePost !== undefined) {",
							"    console.log(\"â© This was a Daily Free Post, skipping liquidity check.\");",
							"} else {",
							"    pm.test(\"Liquidity should decrease after spending\", function () {",
							"        pm.expect(newLiquidity).to.be.below(oldLiquidity, \"Expected liquidity to decrease\");",
							"    });",
							"",
							"    pm.test(\"Liquidity decreased by exactly 20\", function () {",
							"        let expectedChange = 20;",
							"        let actualChange = oldLiquidity - newLiquidity;",
							"        pm.expect(actualChange).to.be.closeTo(expectedChange, 0.01, `Expected liquidity to decrease by ${expectedChange}, but got ${actualChange}`);",
							"    });",
							"",
							"    if (newLiquidity !== undefined) {",
							"        pm.environment.set(\"liquidity\", newLiquidity);",
							"    }",
							"}",
							"",
							"pm.environment.unset(\"isDailyFreePost\");",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"packages": {},
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post photo with cover",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11508\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        input: {\n            title: \"meowwwww\"\n            media: [\"{{new_profile_pic}}\",\"{{base64_photo1}}\",\"{{base64_photo2}}\"]\n            mediadescription: \"{{invalid_email}}\"\n            contenttype: image\n            cover: \"{{new_profile_pic}}\"\n            tags: [\"{{Camelcasetag}}\", \"{{Lowercasetag}}\", \"{{Uppercasetag}}\"] \n        }\n        action: POST  \n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n        }\n         \n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Listposts (confirm tags)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"All tags for created post are lowercase\", function () {",
							"    let body;",
							"",
							"    try {",
							"        body = pm.response.json();",
							"    } catch (e) {",
							"        throw new Error(\"Response is not valid JSON\");",
							"    }",
							"",
							"    const listPosts = body?.data?.listPosts;",
							"    const posts = listPosts?.affectedRows;",
							"",
							"    pm.expect(posts, \"listPosts.affectedRows should exist\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    const postId = pm.environment.get(\"postid\");",
							"    pm.expect(postId, \"Environment variable 'postid' must be set\").to.exist;",
							"",
							"    const targetPost = posts.find(p => String(p.id) === String(postId));",
							"    pm.expect(targetPost, `Post with id ${postId} should be present in response`).to.exist;",
							"",
							"    const tags = targetPost.tags;",
							"    pm.expect(tags, \"tags should be an array\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    tags.forEach(tag => {",
							"        pm.expect(tag, `Tag \"${tag}\" should be lowercase`).to.equal(tag.toLowerCase());",
							"    });",
							"",
							"    console.log(\"Tags for post\", postId, \":\", tags);",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        status\n        counter\n        ResponseCode\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            visibilityStatus\n            isHiddenForUsers\n            hasActiveReports\n            amountreports\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            url\n            user {\n                id\n                username\n                slug\n                img\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                isfollowed\n                isfollowing\n                isreported\n                isfriend\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                amountlikes\n                amountreplies\n                amountreports\n                isreported\n                isliked\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    visibilityStatus\n                    isHiddenForUsers\n                    hasActiveReports\n                    isfollowed\n                    isfollowing\n                    isreported\n                    isfriend\n                }\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check if cover is not there",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let post = response?.data?.listPosts?.affectedRows?.[0];",
							"",
							"pm.test(\"Cover field is empty\", function () {",
							"    pm.expect(post.cover).to.eql(\"\", \"Expected 'cover' to be an empty string\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post text",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11508\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(action: POST, input: { title: \"text's\", mediadescription: \"text's\", contenttype: text, media: [\"{{new_bio}}\"], cover: \"{{base64_photo1}}\", tags: [\"{{Camelcasetag}}\", \"{{Lowercasetag}}\", \"{{Uppercasetag}}\"]  }) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Listposts (confirm tags)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"All tags for created post are lowercase\", function () {",
							"    let body;",
							"",
							"    try {",
							"        body = pm.response.json();",
							"    } catch (e) {",
							"        throw new Error(\"Response is not valid JSON\");",
							"    }",
							"",
							"    const listPosts = body?.data?.listPosts;",
							"    const posts = listPosts?.affectedRows;",
							"",
							"    pm.expect(posts, \"listPosts.affectedRows should exist\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    const postId = pm.environment.get(\"postid\");",
							"    pm.expect(postId, \"Environment variable 'postid' must be set\").to.exist;",
							"",
							"    const targetPost = posts.find(p => String(p.id) === String(postId));",
							"    pm.expect(targetPost, `Post with id ${postId} should be present in response`).to.exist;",
							"",
							"    const tags = targetPost.tags;",
							"    pm.expect(tags, \"tags should be an array\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    tags.forEach(tag => {",
							"        pm.expect(tag, `Tag \"${tag}\" should be lowercase`).to.equal(tag.toLowerCase());",
							"    });",
							"",
							"    console.log(\"Tags for post\", postId, \":\", tags);",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        status\n        counter\n        ResponseCode\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            visibilityStatus\n            isHiddenForUsers\n            hasActiveReports\n            amountreports\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            url\n            user {\n                id\n                username\n                slug\n                img\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                isfollowed\n                isfollowing\n                isreported\n                isfriend\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                amountlikes\n                amountreplies\n                amountreports\n                isreported\n                isliked\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    visibilityStatus\n                    isHiddenForUsers\n                    hasActiveReports\n                    isfollowed\n                    isfollowing\n                    isreported\n                    isfriend\n                }\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check if there is no cover and /",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let post = response?.data?.listPosts?.affectedRows?.[0];",
							"",
							"pm.test(\"Cover field is empty\", function () {",
							"    pm.expect(post.cover).to.eql(\"\", \"Expected 'cover' to be an empty string\");",
							"});",
							"pm.test(\"Title is exactly \\\"text's\\\"\", function () {",
							"    pm.expect(post.title).to.eql(\"text's\");",
							"});",
							"pm.test(\"Media description is exactly \\\"text's\\\"\", function () {",
							"    pm.expect(post.mediadescription).to.eql(\"text's\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post audio",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11508\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(action: POST, input: { title: \"audio\", contenttype: audio, media: [\"{{base64_audio}}\"], cover: \"{{base64_photo1}}\",tags: [\"{{Camelcasetag}}\", \"{{Lowercasetag}}\", \"{{Uppercasetag}}\"] }) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Listposts (confirm tags)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"All tags for created post are lowercase\", function () {",
							"    let body;",
							"",
							"    try {",
							"        body = pm.response.json();",
							"    } catch (e) {",
							"        throw new Error(\"Response is not valid JSON\");",
							"    }",
							"",
							"    const listPosts = body?.data?.listPosts;",
							"    const posts = listPosts?.affectedRows;",
							"",
							"    pm.expect(posts, \"listPosts.affectedRows should exist\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    const postId = pm.environment.get(\"postid\");",
							"    pm.expect(postId, \"Environment variable 'postid' must be set\").to.exist;",
							"",
							"    const targetPost = posts.find(p => String(p.id) === String(postId));",
							"    pm.expect(targetPost, `Post with id ${postId} should be present in response`).to.exist;",
							"",
							"    const tags = targetPost.tags;",
							"    pm.expect(tags, \"tags should be an array\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    tags.forEach(tag => {",
							"        pm.expect(tag, `Tag \"${tag}\" should be lowercase`).to.equal(tag.toLowerCase());",
							"    });",
							"",
							"    console.log(\"Tags for post\", postId, \":\", tags);",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        status\n        counter\n        ResponseCode\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            visibilityStatus\n            isHiddenForUsers\n            hasActiveReports\n            amountreports\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            url\n            user {\n                id\n                username\n                slug\n                img\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                isfollowed\n                isfollowing\n                isreported\n                isfriend\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                amountlikes\n                amountreplies\n                amountreports\n                isreported\n                isliked\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    visibilityStatus\n                    isHiddenForUsers\n                    hasActiveReports\n                    isfollowed\n                    isfollowing\n                    isreported\n                    isfriend\n                }\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check if cover is there",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let post = response?.data?.listPosts?.affectedRows?.[0];",
							"",
							"pm.test(\"Cover field is not empty\", function () {",
							"    pm.expect(post.cover).to.be.a(\"string\").and.to.not.eql(\"\", \"Expected 'cover' to be a non-empty string\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post video",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11508\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							"",
							"",
							"pm.test(\"Video resolution matches expected (720x1280)\", function () {",
							"    try {",
							"        const expectedResolution = \"720x1280\"; // ",
							"",
							"        const affected = postResponse?.data?.createPost?.affectedRows;",
							"        const mediaJson = affected?.media;",
							"",
							"        if (!mediaJson) {",
							"            throw new Error(\"Missing media array in response.\");",
							"        }",
							"",
							"        const mediaArray = JSON.parse(mediaJson);",
							"        if (!Array.isArray(mediaArray) || !mediaArray[0]) {",
							"            throw new Error(\"Media array is empty or invalid.\");",
							"        }",
							"",
							"        const actualResolution = mediaArray[0]?.options?.resolution;",
							"",
							"        pm.expect(actualResolution, `Expected resolution to be ${expectedResolution} but got ${actualResolution}`)",
							"          .to.eql(expectedResolution);",
							"    } catch (err) {",
							"        console.error(\"Video resolution test failed:\", err.message || err);",
							"        throw new Error(\"Video resolution test failed. See console for details.\");",
							"    }",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        input: {\n            title: \"meowwwww\"\n            media: [\"{{base64_video}}\"]\n            contenttype: video\n            tags: [\"{{Camelcasetag}}\", \"{{Lowercasetag}}\", \"{{Uppercasetag}}\"]\n        }\n        action: POST  \n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n        }\n    }\n}\n\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Listposts (confirm tags)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"All tags for created post are lowercase\", function () {",
							"    let body;",
							"",
							"    try {",
							"        body = pm.response.json();",
							"    } catch (e) {",
							"        throw new Error(\"Response is not valid JSON\");",
							"    }",
							"",
							"    const listPosts = body?.data?.listPosts;",
							"    const posts = listPosts?.affectedRows;",
							"",
							"    pm.expect(posts, \"listPosts.affectedRows should exist\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    const postId = pm.environment.get(\"postid\");",
							"    pm.expect(postId, \"Environment variable 'postid' must be set\").to.exist;",
							"",
							"    const targetPost = posts.find(p => String(p.id) === String(postId));",
							"    pm.expect(targetPost, `Post with id ${postId} should be present in response`).to.exist;",
							"",
							"    const tags = targetPost.tags;",
							"    pm.expect(tags, \"tags should be an array\").to.be.an(\"array\").that.is.not.empty;",
							"",
							"    tags.forEach(tag => {",
							"        pm.expect(tag, `Tag \"${tag}\" should be lowercase`).to.equal(tag.toLowerCase());",
							"    });",
							"",
							"    console.log(\"Tags for post\", postId, \":\", tags);",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        status\n        counter\n        ResponseCode\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            visibilityStatus\n            isHiddenForUsers\n            hasActiveReports\n            amountreports\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            url\n            user {\n                id\n                username\n                slug\n                img\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                isfollowed\n                isfollowing\n                isreported\n                isfriend\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                amountlikes\n                amountreplies\n                amountreports\n                isreported\n                isliked\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    visibilityStatus\n                    isHiddenForUsers\n                    hasActiveReports\n                    isfollowed\n                    isfollowing\n                    isreported\n                    isfriend\n                }\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check if cover is a first frame",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"Cover is a first frame\", function () {",
							"    const response = pm.response.json();",
							"",
							"    const post = response.data?.listPosts?.affectedRows?.[0];",
							"    if (!post) {",
							"        throw new Error(\"No post found.\");",
							"    }",
							"",
							"    let cover;",
							"    try {",
							"        cover = JSON.parse(post.cover);",
							"    } catch (e) {",
							"        throw new Error(\"Failed to parse cover JSON.\");",
							"    }",
							"",
							"    const sizeStr = cover[0]?.options?.size?.replace(\" KB\", \"\");",
							"    const sizeInKB = parseFloat(sizeStr);",
							"",
							"    pm.expect(sizeInKB, \"Cover size should be under 20 KB\").to.be.below(20);",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post with tags",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11508\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"function generateRandomUsername() {",
							"    const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';",
							"    let username = '';",
							"    for (let i = 0; i < 10; i++) { // Username length (10 characters)",
							"        username += chars.charAt(Math.floor(Math.random() * chars.length));",
							"    }",
							"    return username;",
							"}",
							"",
							"// Generate and save the random username in the environment",
							"let randomUsername = generateRandomUsername();",
							"pm.environment.set(\"tag\", randomUsername);",
							"console.log(\"Generated Random tag:\", randomUsername);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: { title: \"post with tags\", contenttype: image, media: \"{{base64_photo1}}\", tags: [\"{{tag}}\"] }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "List tags",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11701\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"listTags.affectedRows is array of Tag objects\", function () {",
							"    let body;",
							"",
							"    try {",
							"        body = pm.response.json();",
							"    } catch (e) {",
							"        throw new Error(\"Response is not valid JSON\");",
							"    }",
							"",
							"    const listTags = body?.data?.listTags;",
							"    pm.expect(listTags, \"data.listTags should exist\").to.exist;",
							"",
							"    const rows = listTags?.affectedRows;",
							"    pm.expect(rows, \"listTags.affectedRows should exist\").to.be.an(\"array\");",
							"",
							"    rows.forEach((t, i) => {",
							"        pm.expect(t, `Tag at index ${i} should be an object`).to.be.an(\"object\");",
							"        pm.expect(t, `Tag at index ${i} should have name`).to.have.property(\"name\");",
							"        pm.expect(t.name, `Tag.name at index ${i} should be string`).to.be.a(\"string\");",
							"    });",
							"});",
							"",
							"pm.test(\"All tag names are lowercase\", function () {",
							"    let body;",
							"",
							"    try {",
							"        body = pm.response.json();",
							"    } catch (e) {",
							"        throw new Error(\"Response is not valid JSON\");",
							"    }",
							"",
							"    const rows = body?.data?.listTags?.affectedRows;",
							"    pm.expect(rows, \"listTags.affectedRows should exist\").to.be.an(\"array\");",
							"",
							"    rows.forEach(t => {",
							"        pm.expect(t.name, `Tag \\\"${t.name}\\\" should be lowercase`).to.equal(t.name.toLowerCase());",
							"    });",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListTags {\n    listTags(offset: 0, limit: 20) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            name\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check if tag is there",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11701\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query SearchTags {\n    searchTags(tagName: \"{{tag}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            name\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "No tags found",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"21701\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"function generateRandomUsername() {",
							"    const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';",
							"    let username = '';",
							"    for (let i = 0; i < 10; i++) { // Username length (10 characters)",
							"        username += chars.charAt(Math.floor(Math.random() * chars.length));",
							"    }",
							"    return username;",
							"}",
							"",
							"// Generate and save the random username in the environment",
							"let randomUsername = generateRandomUsername();",
							"pm.environment.set(\"notag\", randomUsername);",
							"console.log(\"Generated Random tag:\", randomUsername);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query SearchTags {\n    searchTags(tagName: \"{{notag}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            name\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Posting with special characters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11508\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        input: {\n            title: \"ðŸŽ‰ðŸ”¥ Test Post! @#$%^&*()\"\n            media: \"{{new_profile_pic}}\"\n            mediadescription: \"Testing special characters: ðŸ’¡ðŸ“â—ï¸\"\n            contenttype: image\n        }\n        action: POST\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n        }\n         \n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload media file photo",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11515\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const response = pm.response.json();",
							"",
							"if (response.uploadedFiles) {",
							"    pm.environment.set(\"uploadedFiles\", response.uploadedFiles);",
							"    console.log(\"uploadedFiles saved as:\", response.uploadedFiles);",
							"} else {",
							"    pm.test(\"uploadedFiles field is missing\", function () {",
							"        pm.expect(false).to.be.true;",
							"    });",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file",
							"type": "file",
							"src": "/etc/newman/media_files/sample_image.jpg"
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create multipart photo post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11508\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							"",
							"let response = pm.response.json();",
							"let post = response?.data?.createPost?.affectedRows;",
							"",
							"pm.test(\"Cover field is an empty string\", function () {",
							"    pm.expect(post.cover).to.eql(\"\", \"Expected 'cover' to be an empty string\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: {\n            title: \"test\"\n            contenttype: video\n            uploadedFiles: \"{{uploadedFiles}}\"\n        }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create same post (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31511\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: {\n            title: \"popa\"\n            contenttype: video\n            uploadedFiles: \"{{uploadedFiles}}\"\n        }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload media file video",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11515\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const response = pm.response.json();",
							"",
							"if (response.uploadedFiles) {",
							"    pm.environment.set(\"uploadedFiles\", response.uploadedFiles);",
							"    console.log(\"uploadedFiles saved as:\", response.uploadedFiles);",
							"} else {",
							"    pm.test(\"uploadedFiles field is missing\", function () {",
							"        pm.expect(false).to.be.true;",
							"    });",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file",
							"type": "file",
							"src": "/etc/newman/media_files/sample_video.mp4"
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create multipart video post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11508\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							"",
							"let response = pm.response.json();",
							"let post = response?.data?.createPost?.affectedRows;",
							"",
							"pm.test(\"Cover field is not empty\", function () {",
							"    pm.expect(post.cover).not.to.eql(\"\", \"Expected 'cover' to be not empty\");",
							"});",
							"",
							"pm.test(\"URL field is present and not empty\", function () {",
							"    pm.expect(post).to.have.property(\"url\");",
							"    pm.expect(post.url).to.not.be.empty;",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: {\n            title: \"test\"\n            contenttype: image\n            uploadedFiles: \"{{uploadedFiles}}\"\n        }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            url\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Guest list post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"let post = response?.data?.guestListPost?.affectedRows;",
							"",
							"pm.test(\"URL field is present and not empty\", function () {",
							"    pm.expect(post).to.have.property(\"url\");",
							"    pm.expect(post.url).to.not.be.empty;",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query GuestListPost {\n    guestListPost(postid: \"{{postid}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            url\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload media file audio",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11515\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const response = pm.response.json();",
							"",
							"if (response.uploadedFiles) {",
							"    pm.environment.set(\"uploadedFiles\", response.uploadedFiles);",
							"    console.log(\"uploadedFiles saved as:\", response.uploadedFiles);",
							"} else {",
							"    pm.test(\"uploadedFiles field is missing\", function () {",
							"        pm.expect(false).to.be.true;",
							"    });",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file",
							"type": "file",
							"src": "/etc/newman/media_files/sample_audio.mp3"
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create multipart audio post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    const responseText = pm.response.text();",
							"    pm.expect(",
							"        responseText.includes(\"11513\") || responseText.includes(\"11508\")",
							"    ).to.be.true;",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							"",
							"let postResponseCode = \"\";",
							"try {",
							"    postResponseCode = postResponse?.data?.createPost?.ResponseCode || \"\";",
							"} catch (err) {",
							"    console.log(\"Couldn't access ResponseCode:\", err);",
							"}",
							"",
							"if (postResponseCode === \"11513\") {",
							"    pm.environment.set(\"isDailyFreePost\", \"true\");",
							"    console.log(\"This was a Daily Free Post (code 11513).\");",
							"} else {",
							"    pm.environment.unset(\"isDailyFreePost\");",
							"    console.log(\"Not a Daily Free Post (code not 11513).\");",
							"}",
							"",
							"let response = pm.response.json();",
							"let post = response?.data?.createPost?.affectedRows;",
							"",
							"pm.test(\"Cover field is empty string\", function () {",
							"    pm.expect(post.cover).to.eql(\"\", \"Expected 'cover' to be an empty string\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: {\n            title: \"test\"\n            contenttype: video\n            uploadedFiles: \"{{uploadedFiles}}\"\n        }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload media file text",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11515\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const response = pm.response.json();",
							"",
							"if (response.uploadedFiles) {",
							"    pm.environment.set(\"uploadedFiles\", response.uploadedFiles);",
							"    console.log(\"uploadedFiles saved as:\", response.uploadedFiles);",
							"} else {",
							"    pm.test(\"uploadedFiles field is missing\", function () {",
							"        pm.expect(false).to.be.true;",
							"    });",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file",
							"type": "file",
							"src": "/etc/newman/media_files/sample_text.txt"
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create multipart text post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    const responseText = pm.response.text();",
							"    pm.expect(",
							"        responseText.includes(\"11513\") || responseText.includes(\"11508\")",
							"    ).to.be.true;",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postResponse = {};",
							"try {",
							"    postResponse = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse response as JSON:\", err);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const postId = postResponse?.data?.createPost?.affectedRows?.id;",
							"        if (postId) {",
							"            pm.environment.set(\"postid\", postId);",
							"            console.log(\"postid set to:\", postId);",
							"        } else {",
							"            console.log(\"No postid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Couldn't access post ID:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping postid set.\");",
							"}",
							"",
							"let postResponseCode = \"\";",
							"try {",
							"    postResponseCode = postResponse?.data?.createPost?.ResponseCode || \"\";",
							"} catch (err) {",
							"    console.log(\"Couldn't access ResponseCode:\", err);",
							"}",
							"",
							"if (postResponseCode === \"11513\") {",
							"    pm.environment.set(\"isDailyFreePost\", \"true\");",
							"    console.log(\"This was a Daily Free Post (code 11513).\");",
							"} else {",
							"    pm.environment.unset(\"isDailyFreePost\");",
							"    console.log(\"Not a Daily Free Post (code not 11513).\");",
							"}",
							"",
							"let response = pm.response.json();",
							"let post = response?.data?.createPost?.affectedRows;",
							"",
							"pm.test(\"Cover field is empty string\", function () {",
							"    pm.expect(post.cover).to.eql(\"\", \"Expected 'cover' to be an empty string\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: {\n            title: \"test\"\n            contenttype: video\n            uploadedFiles: \"{{uploadedFiles}}\"\n        }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload media not existing file",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30102\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file",
							"type": "file",
							"src": "/Users/abdullamuradov/Downloads/report_12.html"
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload media without token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30102\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "file",
							"type": "file",
							"src": "/etc/newman/media_files/sample_image.jpg"
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload more than 20 photo",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30267\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file[]",
							"type": "file",
							"src": [
								"/etc/newman/media_files/image_01.jpg",
								"/etc/newman/media_files/image_02.jpg",
								"/etc/newman/media_files/image_03.jpg",
								"/etc/newman/media_files/image_04.jpg",
								"/etc/newman/media_files/image_05.jpg",
								"/etc/newman/media_files/image_06.jpg",
								"/etc/newman/media_files/image_07.jpg",
								"/etc/newman/media_files/image_08.jpg",
								"/etc/newman/media_files/image_09.jpg",
								"/etc/newman/media_files/image_10.jpg",
								"/etc/newman/media_files/image_11.jpg",
								"/etc/newman/media_files/image_12.jpg",
								"/etc/newman/media_files/image_13.jpg",
								"/etc/newman/media_files/image_14.jpg",
								"/etc/newman/media_files/image_15.jpg",
								"/etc/newman/media_files/image_16.jpg",
								"/etc/newman/media_files/image_17.jpg",
								"/etc/newman/media_files/image_18.jpg",
								"/etc/newman/media_files/image_19.jpg",
								"/etc/newman/media_files/image_20.jpg",
								"/etc/newman/media_files/sample-picture.png"
							]
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload more than 2 video",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30267\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file[]",
							"type": "file",
							"src": [
								"/etc/newman/media_files/file_example_MP4_480_1_5MG.mp4",
								"/etc/newman/media_files/file_example_MP4_480_1_5MG.mp4",
								"/etc/newman/media_files/file_example_MP4_480_1_5MG.mp4"
							]
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload more than 1 text",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30267\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file[]",
							"type": "file",
							"src": [
								"/etc/newman/media_files/Sample_Text_File_10kb_1.txt",
								"/etc/newman/media_files/Sample_Text_File_10kb_1.txt"
							]
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eligibility token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10901\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let token = response?.data?.postEligibility?.eligibilityToken;",
							"",
							"if (token) {",
							"    pm.environment.set(\"eligibilityToken\", token);",
							"    console.log(\"Eligibility token saved to environment.\");",
							"} else {",
							"    console.warn(\"Eligibility token not found in response.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostEligibility {\n    postEligibility {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        eligibilityToken\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload more than 1 audio",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30267\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file[]",
							"type": "file",
							"src": [
								"/etc/newman/media_files/MP3-5MB-Example.mp3",
								"/etc/newman/media_files/MP3-5MB-Example.mp3"
							]
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload empty file",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"40307\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file",
							"type": "file",
							"src": "/etc/newman/media_files/empty.txt"
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Upload all types of media",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30266\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{accessToken}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "eligibilityToken",
							"value": "{{eligibilityToken}}",
							"type": "text"
						},
						{
							"key": "file[]",
							"type": "file",
							"src": [
								"/etc/newman/media_files/bullshit.txt",
								"/etc/newman/media_files/MP3-5MB-Example.mp3"
							]
						}
					]
				},
				"url": {
					"raw": "{{test-backend}}/upload-post",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"upload-post"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post fake file",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31511\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: {\n            title: \"test\"\n            contenttype: video\n            uploadedFiles: \"{{uuid}}.txt\"\n        }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post with more than 10 tags",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30262\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: { title: \"post with tags\", contenttype: image, media: \"{{new_profile_pic}}\", tags: [\"hi\", \"hi1\", \"hi2\", \"hi3\", \"hi4\", \"hi5\", \"hi6\", \"hi7\", \"hi8\", \"hi9\", \"hi10\", \"hi11\"] }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post with too short tag",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30262\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: { title: \"post with tags\", contenttype: image, media: \"{{new_profile_pic}}\", tags: [\"{{long_message}}\"] }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post with too long tag",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30262\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        action: POST\n        input: { title: \"post with tags\", contenttype: image, media: \"{{new_profile_pic}}\", tags: [\"{{long_message}}\"] }\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post more than 1 text (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30267\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(action: POST, input: { title: \"text\", contenttype: text, media: [\"{{new_bio}}\", \"{{new_bio}}\", \"{{new_bio}}\"] }) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post more than 2 video (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30267\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        input: {\n            title: \"meowwwww\"\n            media: [\"{{base64_video}}\",\"{{base64_video}}\",\"{{base64_video}}\"]\n            mediadescription: \"{{invalid_email}}\"\n            contenttype: video\n        }\n        action: POST  \n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n        }\n         \n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post more than 1 audio (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30267\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(action: POST, input: { title: \"audio\", contenttype: audio, media: [\"{{base64_audio}}\", \"{{base64_audio}}\"] }) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post more than 1 cover (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30268\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(action: POST, input: { title: \"audio\", contenttype: audio, media: [\"{{base64_audio}}\"], cover: [\"{{base64_photo1}}\", \"{{base64_photo2}}\"] }) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post all types of media (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30251\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(action: POST, input: { title: \"all media\", contenttype: image, media: [\"{{base64_audio}}\", \"{{base64_video}}\", \"{{new_bio}}\", \"{{new_profile_pic}}\"] }) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Post empty title (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30210\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        input: {\n            title: \"\"\n            media: \"{{new_profile_pic}}\"\n            contenttype: image\n        }\n        action: POST  \n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n        }\n         \n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Post empty media (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30251\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        input: {\n            title: \"empty\"\n            media: \"\"\n            contenttype: image\n        }\n        action: POST  \n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n        }\n         \n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create post too long text",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30263\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let longMessage = \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. \".repeat(100);",
							"pm.environment.set(\"long_message\", longMessage);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        input: {\n            title: \"meowwwww\"\n            media: \"{{new_profile_pic}}\"\n            mediadescription: \"{{long_message}}\"\n            contenttype: image\n        }\n        action: POST  \n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n        }\n         \n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Try posting with an invalid media format (should fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30251\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreatePost {\n    createPost(\n        input: {\n            title: \"Invalid Media Test\"\n            media: \"https://example.com/file.exe\"  \n            mediadescription: \"This should fail due to invalid format\"\n            contenttype: image\n        }\n        action: POST\n    ) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n        }\n         \n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = Number(pm.environment.get(\"liquidity\"));",
							"",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"",
							"pm.test(\"Liquidity should remain the same\", function () {",
							"    pm.expect(newLiquidity).to.eql(oldLiquidity);",
							"});",
							"",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Comment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let commentResponse = {};",
							"try {",
							"    commentResponse = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let commentResponseCode = \"\";",
							"let status = \"\";",
							"",
							"try {",
							"    status = commentResponse?.data?.createComment?.meta?.status || \"\";",
							"    commentResponseCode = commentResponse?.data?.createComment?.meta?.ResponseCode || \"\";",
							"} catch (e) {",
							"    console.log(\"Error accessing response properties:\", e);",
							"}",
							"",
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect([\"11605\", \"11608\"]).to.include(commentResponseCode);",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(status).to.eql(\"success\");",
							"});",
							"",
							"if (commentResponseCode === \"11608\") {",
							"    pm.environment.set(\"isDailyFreeComment\", \"true\");",
							"    console.log(\"This was a Daily Free Comment.\");",
							"} else {",
							"    pm.environment.unset(\"isDailyFreeComment\");",
							"    console.log(\"Not a Daily Free Comment.\");",
							"}",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (err) {",
							"    console.log(\"Failed to parse JSON:\", err);",
							"}",
							"if (!pm.response.text().includes(\"error\")) {",
							"    try {",
							"        const commentId = response?.data?.createComment?.affectedRows?.[0]?.commentid;",
							"        if (commentId) {",
							"            pm.environment.set(\"commentid\", commentId);",
							"            console.log(\"commentid set to:\", commentId);",
							"        } else {",
							"            console.log(\"No commentid found in response.\");",
							"        }",
							"    } catch (err) {",
							"        console.log(\"Error extracting commentid:\", err);",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping commentid set.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation createComment {\n    createComment(action: COMMENT, postid: \"{{postid}}\", content: \"{{comment_content}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            commentid\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let newLiquidityAfterComment = response?.data?.balance?.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity\");",
							"let isDailyFreeComment = pm.environment.get(\"isDailyFreeComment\");",
							"let commentResponseCode = response?.data?.createComment?.ResponseCode || \"\";",
							"",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"",
							"if (isDailyFreeComment !== undefined) {",
							"    console.log(\"â© This was a Daily Free Comment, skipping liquidity check.\");",
							"} else {",
							"    pm.test(\"Liquidity should decrease after commenting\", function () {",
							"        pm.expect(newLiquidityAfterComment).to.be.below(oldLiquidity);",
							"    });",
							"",
							"    if (newLiquidityAfterComment !== undefined) {",
							"        pm.environment.set(\"liquidity\", newLiquidityAfterComment);",
							"    }",
							"}",
							"",
							"pm.environment.unset(\"isDailyFreeComment\");"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check if there is no /",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let post = response?.data?.listPosts?.affectedRows?.[0];",
							"let comment = post.comments[0];",
							"",
							"pm.test(\"Comment content is exactly \\\"myaaaaauuuuu's\\\"\", function () {",
							"    pm.expect(comment.content).to.eql(\"myaaaaauuuuu's\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPosts {\n    listPosts(postid: \"{{postid}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Comment with empty(should fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30265\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreateComment {\n    createComment(action: COMMENT, postid: \"{{postid}}\", content: \"\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Comment too long text",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30265\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let longMessage = \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. \".repeat(100);",
							"pm.environment.set(\"long_message\", longMessage);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreateComment {\n    createComment(action: COMMENT, postid: \"{{postid}}\", content: \"{{long_message}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Like your post (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31506\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(postid:\"{{postid}}\" , action: LIKE) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Dislike your post (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31507\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(postid:\"{{postid}}\" , action: DISLIKE) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Report your post (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31508\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(\n        postid: \"{{postid}}\"\n        action: REPORT\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Share your post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11507\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(\n        postid: \"{{postid}}\"\n        action: SHARE\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Double share your post (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31504\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(\n        postid: \"{{postid}}\"\n        action: SHARE\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "View your post (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31509\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(\n        postid: \"{{postid}}\"\n        action: VIEW\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Save your post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11512\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolvePostAction {\n    resolvePostAction(action: SAVE, postid: \"{{postid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Unsave your post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11511\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolvePostAction {\n    resolvePostAction(action: SAVE, postid: \"{{postid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Like your comment (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31606\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation LikeComment {\n    likeComment(commentid: \"{{commentid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Report your comment (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31607\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ReportComment {\n    reportComment(\n        commentid: \"{{commentid}}\"\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response?.data?.balance?.currentliquidity;",
							"let oldLiquidity = Number(pm.environment.get(\"liquidity\"));",
							"",
							"console.log(`Old Liquidity: ${oldLiquidity}`);",
							"console.log(`New Liquidity: ${newLiquidity}`);",
							"",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"",
							"pm.test(\"Liquidity should stay the same\", function () {",
							"    pm.expect(newLiquidity).to.equal(oldLiquidity, \"Expected liquidity to stay the same\");",
							"});",
							"",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(\"Updated liquidity in environment:\", newLiquidity);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11211\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"",
							"const tokenAmount =",
							"    json?.data?.resolveTransferV2?.affectedRows?.tokensSubstractedFromWallet;",
							"",
							"pm.test(\"tokensSubstractedFromWallet exists\", () => {",
							"    pm.expect(tokenAmount).to.not.be.undefined;",
							"    pm.expect(tokenAmount).to.not.be.null;",
							"});",
							"",
							"pm.environment.set(\"tokenamount\", Number(tokenAmount));",
							"",
							"console.log(\"tokenamount set to:\", tokenAmount);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{userid}}\", numberoftokens: 160, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = parseFloat(pm.environment.get(\"liquidity\"));",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"let expectedDecrease = 164.8;",
							"let actualDecrease = oldLiquidity - newLiquidity;",
							"let tolerance = 0.1;",
							"pm.test(`Liquidity should decrease by approximately ${expectedDecrease} Â±${tolerance}`, function () {",
							"    pm.expect(actualDecrease).to.be.within(expectedDecrease - tolerance, expectedDecrease + tolerance);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}, Decreased by: ${actualDecrease}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11215\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let transactions = response?.data?.getTransactionHistory?.affectedRows || [];",
							"",
							"let credit = transactions.find(tx => tx.transferaction === \"CREDIT\");",
							"",
							"pm.test(\"CREDIT transaction has correct message\", function () {",
							"    pm.expect(credit).to.not.be.undefined;",
							"    pm.expect(credit.message).to.eql(\"hi\");",
							"    pm.expect(credit?.tokenamount).to.eql(160);",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query GetTransactionHistory {\n    getTransactionHistory(limit: 5) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            transactionid\n            operationid\n            transactiontype\n            senderid\n            recipientid\n            tokenamount\n            transferaction\n            message\n            createdat\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer decimal amount",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11211\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"",
							"const tokenAmount =",
							"    json?.data?.resolveTransferV2?.affectedRows?.tokensSubstractedFromWallet;",
							"",
							"pm.test(\"tokensSubstractedFromWallet exists\", () => {",
							"    pm.expect(tokenAmount).to.not.be.undefined;",
							"    pm.expect(tokenAmount).to.not.be.null;",
							"});",
							"",
							"pm.environment.set(\"tokenamount\", Number(tokenAmount));",
							"",
							"console.log(\"tokenamount set to:\", tokenAmount);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{userid}}\", numberoftokens: 0.5, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = parseFloat(pm.environment.get(\"liquidity\"));",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"let expectedDecrease = 0.52;",
							"let actualDecrease = oldLiquidity - newLiquidity;",
							"let tolerance = 0.1;",
							"pm.test(`Liquidity should decrease by approximately ${expectedDecrease} Â±${tolerance}`, function () {",
							"    pm.expect(actualDecrease).to.be.within(expectedDecrease - tolerance, expectedDecrease + tolerance);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}, Decreased by: ${actualDecrease}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11215\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let transactions = response?.data?.getTransactionHistory?.affectedRows || [];",
							"",
							"let credit = transactions.find(tx => tx.transferaction === \"CREDIT\");",
							"",
							"pm.test(\"CREDIT transaction has correct message\", function () {",
							"    pm.expect(credit).to.not.be.undefined;",
							"    pm.expect(credit.message).to.eql(\"hi\");",
							"    pm.expect(credit?.tokenamount).to.eql(0.5);",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query GetTransactionHistory {\n    getTransactionHistory(limit: 5) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            transactionid\n            operationid\n            transactiontype\n            senderid\n            recipientid\n            tokenamount\n            transferaction\n            message\n            createdat\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer minimum amount",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11211\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"",
							"const tokenAmount =",
							"    json?.data?.resolveTransferV2?.affectedRows?.tokensSubstractedFromWallet;",
							"",
							"pm.test(\"tokensSubstractedFromWallet exists\", () => {",
							"    pm.expect(tokenAmount).to.not.be.undefined;",
							"    pm.expect(tokenAmount).to.not.be.null;",
							"});",
							"",
							"pm.environment.set(\"tokenamount\", Number(tokenAmount));",
							"",
							"console.log(\"tokenamount set to:\", tokenAmount);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t1}}\", numberoftokens: 0.000001, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = parseFloat(pm.environment.get(\"liquidity\"));",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"let expectedDecrease = 0.000001;",
							"let actualDecrease = oldLiquidity - newLiquidity;",
							"let tolerance = 0.00001;",
							"pm.test(`Liquidity should decrease by approximately ${expectedDecrease} Â±${tolerance}`, function () {",
							"    pm.expect(actualDecrease).to.be.within(expectedDecrease - tolerance, expectedDecrease + tolerance);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}, Decreased by: ${actualDecrease}`);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer token to yourself",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31202\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t2}}\", numberoftokens: 5, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer token to invalid id",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31007\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{uuid}}\", numberoftokens: 5, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer token to Peer",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31203\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{peer}}\", numberoftokens: 5, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer token to Burn",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31203\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{burn}}\", numberoftokens: 5, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer token to LP",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31203\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{lp}}\", numberoftokens: 5, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer token to BTCP",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31203\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{btc}}\", numberoftokens: 5, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer 0 token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30264\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: 0, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer negative amount",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30264\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: -5, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer more than you have",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"51301\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: 100000, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer with too long message (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30270\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let longMessage = \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. \".repeat(100);",
							"pm.environment.set(\"long_message\", longMessage);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: 10, message: \"{{long_message}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer with forbidden symbols (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30271\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: 10, message: \"A\\u00A0B\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer with a link (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30271\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: 10, message: \"https://frontend.getpeer.eu/login.php\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer more than 8 decimals (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30264\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: 1.123456789, message: \"\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer less than MIN_AMOUNT (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"30264\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"packages": {},
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: 0.000000001, message: \"\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response?.data?.balance?.currentliquidity;",
							"let oldLiquidity = Number(pm.environment.get(\"liquidity\"));",
							"",
							"console.log(`Old Liquidity: ${oldLiquidity}`);",
							"console.log(`New Liquidity: ${newLiquidity}`);",
							"",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"",
							"pm.test(\"Liquidity should stay the same\", function () {",
							"    pm.expect(newLiquidity).to.equal(oldLiquidity, \"Expected liquidity to stay the same\");",
							"});",
							"",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(\"Updated liquidity in environment:\", newLiquidity);",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Call user move",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11205\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListTodaysInteractions {\n    listTodaysInteractions {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            totalInteractions\n            totalScore\n            totalDetails {\n                views\n                likes\n                dislikes\n                comments\n                viewsScore\n                likesScore\n                dislikesScore\n                commentsScore\n            }\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get referral info",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11011\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query GetReferralInfo {\n    getReferralInfo {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        referralUuid\n        referralLink\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get referral list",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11011\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"ref tester exists\", function () {",
							"    pm.expect(pm.response.text()).to.include(pm.environment.get(\"userid\"));",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ReferralList {\n    referralList(limit: 1) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            invitedBy {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            iInvited {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Login referred tester",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10801\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"accessToken\", response.data.login.accessToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"refreshToken\", response.data.login.refreshToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"let token = pm.environment.get(\"accessToken\");",
							"pm.test(\"Access token exists\", function () {",
							"    pm.expect(token).to.be.a(\"string\");",
							"});",
							"",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation {\n  login(email: \"{{random_email}}\", password: \"{{password}}\") {\n    meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    accessToken\n    refreshToken\n  }\n}\n\n\n\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let liquidity = response.data.balance.currentliquidity;",
							"pm.environment.set(\"liquidity2\", liquidity);",
							"console.log(\"Saved liquidity:\", liquidity);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11215\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"const transactions = response?.data?.getTransactionHistory?.affectedRows || [];",
							"",
							"const hasCredit0_5 = transactions.some(tx => ",
							"    tx.transferaction === \"CREDIT\" && tx.tokenamount === 0.5",
							");",
							"",
							"const hasCredit115 = transactions.some(tx => ",
							"    tx.transferaction === \"CREDIT\" && tx.tokenamount === 160",
							");",
							"",
							"pm.test(\"Contains CREDIT transaction with 0.5 tokens\", function () {",
							"    pm.expect(hasCredit0_5).to.be.true;",
							"});",
							"",
							"pm.test(\"Contains CREDIT transaction with 160 tokens\", function () {",
							"    pm.expect(hasCredit115).to.be.true;",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query GetTransactionHistory {\n    getTransactionHistory(limit: 2) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            transactionid\n            operationid\n            transactiontype\n            senderid\n            recipientid\n            tokenamount\n            transferaction\n            message\n            createdat\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transfer token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11211\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"",
							"const tokenAmount =",
							"    json?.data?.resolveTransferV2?.affectedRows?.tokensSubstractedFromWallet;",
							"",
							"pm.test(\"tokensSubstractedFromWallet exists\", () => {",
							"    pm.expect(tokenAmount).to.not.be.undefined;",
							"    pm.expect(tokenAmount).to.not.be.null;",
							"});",
							"",
							"pm.environment.set(\"tokenamount\", Number(tokenAmount));",
							"",
							"console.log(\"tokenamount set to:\", tokenAmount);"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveTransfer {\n    resolveTransferV2(recipient: \"{{w_userid_t3}}\", numberoftokens: 2, message: \"hi\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            tokenSend\n            tokensSubstractedFromWallet\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = parseFloat(pm.environment.get(\"liquidity2\"));",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"let expectedDecrease = 2.1;",
							"let actualDecrease = oldLiquidity - newLiquidity;",
							"let tolerance = 0.1;",
							"pm.test(`Liquidity should decrease by approximately ${expectedDecrease} Â±${tolerance}`, function () {",
							"    pm.expect(actualDecrease).to.be.within(expectedDecrease - tolerance, expectedDecrease + tolerance);",
							"});",
							"pm.environment.set(\"liquidity2\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}, Decreased by: ${actualDecrease}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11215\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let transactions = response?.data?.getTransactionHistory?.affectedRows || [];",
							"",
							"let credit = transactions.find(tx => tx.transferaction === \"CREDIT\");",
							"let inviterFee = transactions.find(tx => tx.transferaction === \"INVITER_FEE\");",
							"",
							"pm.test(\"CREDIT transaction has correct message and amount\", function () {",
							"    pm.expect(credit).to.not.be.undefined;",
							"    pm.expect(credit.message).to.eql(\"hi\");",
							"    pm.expect(credit.tokenamount).to.eql(2);",
							"});",
							"",
							"pm.test(\"INVITER_FEE exists and amount is 0.02\", function () {",
							"    pm.expect(inviterFee).to.not.be.undefined;",
							"    pm.expect(inviterFee.tokenamount).to.eql(0.02);",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query GetTransactionHistory {\n    getTransactionHistory(limit: 6) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            transactionid\n            operationid\n            transactiontype\n            senderid\n            recipientid\n            tokenamount\n            transferaction\n            message\n            createdat\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Login tester 2",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10801\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"accessToken\", response.data.login.accessToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"refreshToken\", response.data.login.refreshToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"let token = pm.environment.get(\"accessToken\");",
							"pm.test(\"Access token exists\", function () {",
							"    pm.expect(token).to.be.a(\"string\");",
							"});",
							"",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation {\n  login(email: \"{{w_email_t2}}\",\n    password: \"{{w_password_t2}}\"\n  ) {\n    meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    accessToken\n    refreshToken\n  }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity (ref%)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = parseFloat(pm.environment.get(\"liquidity\"));",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"let expectedDecrease = 0.02;",
							"let actualDecrease = newLiquidity - oldLiquidity;",
							"let tolerance = 0.1;",
							"pm.test(`Liquidity should increase by approximately ${expectedDecrease} Â±${tolerance}`, function () {",
							"    pm.expect(actualDecrease).to.be.within(expectedDecrease - tolerance, expectedDecrease + tolerance);",
							"});",
							"pm.environment.set(\"liquidity\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}, Decreased by: ${actualDecrease}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// pm.test(\"ResponseCode is correct\", function () {",
							"//     pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"// });",
							"",
							"// pm.test(\"Status is correct\", function () {",
							"//     pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"// });",
							"",
							"// const json = pm.response.json();",
							"// const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"// const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"// let prevOpIds = pm.environment.get(\"operationid\");",
							"// prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"// const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"// pm.test(\"No duplicate operationid from previous request\", () => {",
							"//     pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"// });",
							"",
							"// const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"// pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"// pm.test(\"affectedRows is non-empty array\", () => {",
							"//     pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"// });",
							"",
							"// const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"// const TOLERANCE = 0.0001;",
							"",
							"// function num(v) {",
							"//     return Number(v);",
							"// }",
							"",
							"// function expectNotNull(value, path) {",
							"//     pm.expect(",
							"//         value !== null && value !== undefined && value !== \"\",",
							"//         `${path} is null/empty`",
							"//     ).to.be.true;",
							"// }",
							"",
							"// function expectPercent(actual, base, percent, path) {",
							"//     const expected = +(base * percent / 100).toFixed(6);",
							"//     pm.expect(",
							"//         actual,",
							"//         `${path} expected ${percent}% (${expected}), got ${actual}`",
							"//     ).to.be.closeTo(expected, TOLERANCE);",
							"// }",
							"",
							"// rows.forEach((tx, i) => {",
							"//     const p = `affectedRows[${i}]`;",
							"",
							"//     pm.test(`${p} mandatory fields not null`, () => {",
							"//         [",
							"//             \"operationid\",",
							"//             \"transactionCategory\",",
							"//             \"transactiontype\",",
							"//             \"tokenamount\",",
							"//             \"netTokenAmount\",",
							"//             \"createdat\"",
							"//         ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"//         [\"sender\", \"recipient\"].forEach(role => {",
							"//             Object.entries(tx[role]).forEach(([k, v]) => {",
							"//                 if (k !== \"updatedat\") {",
							"//                     expectNotNull(v, `${p}.${role}.${k}`);",
							"//                 }",
							"//             });",
							"//         });",
							"",
							"//         [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"//             expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"//         );",
							"//     });",
							"",
							"//     pm.test(`${p} fees calculation`, () => {",
							"//         const base = Math.abs(num(tx.netTokenAmount));",
							"//         const hasInviter = tx.fees.inviter !== null;",
							"",
							"//         expectPercent(",
							"//             num(tx.fees.total),",
							"//             base,",
							"//             hasInviter ? 4 : 3,",
							"//             `${p}.fees.total`",
							"//         );",
							"",
							"//         expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"//         expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"//         if (hasInviter) {",
							"//             expectPercent(",
							"//                 num(tx.fees.inviter),",
							"//                 base,",
							"//                 1,",
							"//                 `${p}.fees.inviter`",
							"//             );",
							"//         }",
							"//     });",
							"",
							"//     pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"//         const token = Math.abs(num(tx.tokenamount));",
							"",
							"//         switch (tx.transactionCategory) {",
							"//             case \"LIKE\":",
							"//             case \"DISLIKE\":",
							"//                 pm.expect(token).to.equal(3);",
							"//                 break;",
							"",
							"//             case \"COMMENT\":",
							"//                 pm.expect(token).to.equal(1);",
							"//                 break;",
							"",
							"//             case \"AD_PINNED\":",
							"//                 pm.expect(",
							"//                     token === 160 || token % 50 === 0,",
							"//                     `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"//                 ).to.be.true;",
							"//                 break;",
							"",
							"//             case \"POST_CREATE\":",
							"//                 pm.expect(token).to.equal(20);",
							"//                 break;",
							"",
							"//             case \"P2P_TRANSFER\":",
							"//                 pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"//                 break;",
							"",
							"//             default:",
							"//                 console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"//         }",
							"//     });",
							"// });"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11215\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (e) {",
							"    console.error(\"Failed to parse response JSON:\", e);",
							"}",
							"",
							"let transactions = response?.data?.getTransactionHistory?.affectedRows || [];",
							"",
							"let inviterFeeTx = transactions.find(tx =>",
							"    tx.transferaction === \"INVITER_FEE\" &&",
							"    tx.tokenamount === 0.02",
							");",
							"",
							"pm.test(\"Inviter fee transaction of 0.02 token exists\", function () {",
							"    pm.expect(inviterFeeTx).to.not.be.undefined;",
							"    pm.expect(inviterFeeTx.tokenamount).to.eql(0.02);",
							"    pm.expect(inviterFeeTx.transferaction).to.eql(\"INVITER_FEE\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query GetTransactionHistory {\n    getTransactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            transactionid\n            operationid\n            transactiontype\n            senderid\n            recipientid\n            tokenamount\n            transferaction\n            message\n            createdat\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Follow tester 3",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11104\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"Account is not followed\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"true\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation UserFollow {\n    toggleUserFollowStatus(userid: \"{{w_userid_t3}}\") {\n        isfollowing\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Login tester 3",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10801\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"accessToken\", response.data.login.accessToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"refreshToken\", response.data.login.refreshToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"let token = pm.environment.get(\"accessToken\");",
							"pm.test(\"Access token exists\", function () {",
							"    pm.expect(token).to.be.a(\"string\");",
							"});",
							"",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation {\n  login(email: \"{{w_email_t3}}\",\n    password: \"{{w_password_t3}}\"\n  ) {\n    meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    accessToken\n    refreshToken\n  }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Follow tester 2",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11104\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"Account is not followed\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"true\");",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation UserFollow {\n    toggleUserFollowStatus(userid: \"{{w_userid_t2}}\") {\n        isfollowing\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Search user",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11009\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query SearchUser {\n    searchUser(userid: \"{{w_userid_t2}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            username\n            status\n            slug\n            img\n            biography\n            createdat\n            updatedat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get profile",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11008\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query GetProfile {\n    getProfile(postLimit: 20, userid: \"{{w_userid_t2}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            username\n            status\n            slug\n            img\n            biography\n            isfollowed\n            isfollowing\n            amountposts\n            amounttrending\n            amountfollowed\n            amountfollower\n            amountfriends\n            amountblocked\n            imageposts {\n                id\n                title\n                contenttype\n                media\n                createdat\n            }\n            textposts {\n                id\n                title\n                contenttype\n                media\n                createdat\n            }\n            videoposts {\n                id\n                title\n                contenttype\n                media\n                createdat\n            }\n            audioposts {\n                id\n                title\n                contenttype\n                media\n                createdat\n            }\n        }\n    }\n}\n\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get all posts",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Getallposts {\n    listPosts(\n        filterBy: null\n        IgnorList: YES\n        sortBy: null\n        userid: null\n        postid: null\n        title: null\n        tag: null\n        from: null\n        to: null\n        offset: null\n        limit: null\n        commentOffset: null\n        commentLimit: null\n    ) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n            comments {\n                commentid\n                userid\n                postid\n                parentid\n                content\n                createdat\n                amountlikes\n                amountreplies\n                isliked\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n                isreported\n                user {\n                    id\n                    username\n                    slug\n                    img\n                    isfollowed\n                    isfollowing\n                isreported\n                visibilityStatus\n          isHiddenForUsers\n                hasActiveReports\n}\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Confirm listfriends",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11102\"');",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"Exactly one record is returned\", function () {",
							"    const body = pm.response.text();",
							"",
							"    const matches = body.match(/\\\"userid\\\"\\s*:/g) || [];",
							"    pm.expect(matches.length).to.eql(1);",
							"});",
							"",
							"const expectedUserId = pm.environment.get(\"w_userid_t3\");",
							"",
							"pm.test(\"Environment variable w_userid_t3 is set\", function () {",
							"    pm.expect(expectedUserId, \"w_userid_t3 must be set\").to.be.a(\"string\");",
							"});",
							"",
							"pm.test(\"Single record userid equals w_userid_t3\", function () {",
							"    pm.expect(pm.response.text()).to.include(`\"userid\":\"${expectedUserId}\"`);",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListFriends {\n    listFriends(userid: \"{{w_userid_t2}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            userid\n            img\n            username\n            slug\n            biography\n            updatedat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Block user",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11105\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation UserBlock {\n    toggleBlockUserStatus(userid: \"{{w_userid_t2}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Block yourself (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31104\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation UserBlock {\n    toggleBlockUserStatus(userid: \"{{w_userid_t3}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Confirm blocking",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11107\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"tester1 exists\", function () {",
							"    pm.expect(pm.response.text()).to.include(pm.environment.get(\"w_userid_t2\"));",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Blockedlist {\n    listBlockedUsers {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            iBlocked {\n                userid\n                img\n                username\n                slug\n          visibilityStatus\n          isHiddenForUsers\n        hasActiveReports\n}\n            blockedBy {\n                userid\n                img\n                username\n                slug\n            visibilityStatus\n          isHiddenForUsers\n        hasActiveReports\n}\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Confirm posts are not seen",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"tester1 exists\", function () {",
							"    pm.expect(pm.response.text()).not.to.include(pm.environment.get(\"w_userid_t2\"));",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Getallposts {\n    listPosts(\n        filterBy: null\n        IgnorList: YES\n        sortBy: null\n        userid: null\n        postid: null\n        title: null\n        tag: null\n        from: null\n        to: null\n        offset: null\n        limit: null\n        commentOffset: null\n        commentLimit: null\n    ) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Unblock user",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11106\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation UserBlock {\n    toggleBlockUserStatus(userid: \"{{w_userid_t2}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Confirm unblocking",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11107\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"tester1 exists\", function () {",
							"    pm.expect(pm.response.text()).to.not.include(pm.environment.get(\"w_userid_t2\"));",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Blockedlist {\n    listBlockedUsers {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            iBlocked {\n                userid\n                img\n                username\n                slug\n            visibilityStatus\n          isHiddenForUsers\n        hasActiveReports\n}\n            blockedBy {\n                userid\n                img\n                username\n                slug\n            visibilityStatus\n          isHiddenForUsers\n        hasActiveReports\n}\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Confirm posts are seen",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"pm.test(\"tester1 exists\", function () {",
							"    pm.expect(pm.response.text()).to.include(pm.environment.get(\"w_userid_t2\"));",
							"});",
							"",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Getallposts {\n    listPosts(\n        filterBy: null\n        IgnorList: YES\n        sortBy: null\n        userid: null\n        postid: null\n        title: null\n        tag: null\n        from: null\n        to: null\n        offset: null\n        limit: null\n        commentOffset: null\n        commentLimit: null\n    ) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            contenttype\n            title\n            media\n            cover\n            mediadescription\n            createdat\n            amountlikes\n            amountviews\n            amountcomments\n            amountdislikes\n            amounttrending\n            isliked\n            isviewed\n            isreported\n            isdisliked\n            issaved\n            tags\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n        }\n    }\n}\n\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity1\");",
							"oldLiquidity = oldLiquidity !== undefined ? Number(oldLiquidity) : undefined;",
							"if (oldLiquidity !== undefined) {",
							"    pm.test(\"Liquidity should increase\", function () {",
							"        pm.expect(newLiquidity).to.be.above(oldLiquidity);",
							"    });",
							"} else {",
							"    console.log(\"No previous liquidity found, skipping increase check.\");",
							"}",
							"pm.environment.set(\"liquidity1\", newLiquidity);",
							"console.log(\"Saved liquidity:\", newLiquidity);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create child comment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let commentResponse = {};",
							"try {",
							"    commentResponse = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let commentResponseCode = \"\";",
							"let status = \"\";",
							"",
							"try {",
							"    status = commentResponse?.data?.createComment?.meta?.status || \"\";",
							"    commentResponseCode = commentResponse?.data?.createComment?.meta?.ResponseCode || \"\";",
							"} catch (e) {",
							"    console.log(\"Error accessing response properties:\", e);",
							"}",
							"",
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect([\"11605\", \"11608\"]).to.include(commentResponseCode);",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(status).to.eql(\"success\");",
							"});",
							"",
							"if (commentResponseCode === \"11608\") {",
							"    pm.environment.set(\"isDailyFreeComment\", \"true\");",
							"    console.log(\"This was a Daily Free Comment.\");",
							"} else {",
							"    pm.environment.unset(\"isDailyFreeComment\");",
							"    console.log(\"Not a Daily Free Comment.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation CreateComment {\n    createComment(action: COMMENT, postid: \"{{postid}}\", content: \"{{comment_content}}\", parentid: \"{{commentid}}\") {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            commentid\n            userid\n            postid\n            parentid\n            content\n            createdat\n            amountlikes\n            amountreplies\n            isliked\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "List child comments",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11607\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListChildComments {\n    listChildComments(parent: \"{{commentid}}\", offset: null, limit: null) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            commentid\n            userid\n            postid\n            parentid\n            content\n            createdat\n            amountlikes\n            amountreplies\n            isliked\n            user {\n                id\n                username\n                slug\n                img\n                isfollowed\n                isfollowing\n            }\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let newLiquidityAfterComment = response?.data?.balance?.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity1\");",
							"let isDailyFreeComment = pm.environment.get(\"isDailyFreeComment\");",
							"let commentResponseCode = response?.data?.createComment?.ResponseCode || \"\";",
							"",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"",
							"if (isDailyFreeComment !== undefined) {",
							"    console.log(\"â© This was a Daily Free Comment, skipping liquidity check.\");",
							"} else {",
							"    pm.test(\"Liquidity should decrease after commenting\", function () {",
							"        pm.expect(newLiquidityAfterComment).to.be.below(oldLiquidity);",
							"    });",
							"",
							"    if (newLiquidityAfterComment !== undefined) {",
							"        pm.environment.set(\"liquidity1\", newLiquidityAfterComment);",
							"    }",
							"}",
							"",
							"pm.environment.unset(\"isDailyFreeComment\");"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Like post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"let likeResponse = {};",
							"try {",
							"    likeResponse = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let likeResponseCode = \"\";",
							"let status = \"\";",
							"",
							"try {",
							"    status = likeResponse?.data?.resolvePostAction?.status || \"\";",
							"    likeResponseCode = likeResponse?.data?.resolvePostAction?.ResponseCode || \"\";",
							"} catch (e) {",
							"    console.log(\"Error accessing response properties:\", e);",
							"}",
							"",
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect([\"11503\", \"11514\"]).to.include(likeResponseCode);",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(status).to.eql(\"success\");",
							"});",
							"",
							"if (likeResponseCode === \"11514\") {",
							"    pm.environment.set(\"isDailyFreeLike\", \"true\");",
							"    console.log(\"This was a Daily Free Like.\");",
							"} else {",
							"    pm.environment.unset(\"isDailyFreeLike\");",
							"    console.log(\"Not a Daily Free Like.\");",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(postid:\"{{postid}}\" , action: LIKE) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Content engagement (like)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    const responseText = pm.response.text();",
							"    pm.expect(responseText.includes(\"11205\")).to.be.true;",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postInteractionResponse = {};",
							"try {",
							"    postInteractionResponse = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let interactionResponseCode = \"\";",
							"let affectedId = \"\";",
							"",
							"try {",
							"    interactionResponseCode = postInteractionResponse?.data?.postInteractions?.ResponseCode || \"\";",
							"    affectedId = postInteractionResponse?.data?.postInteractions?.affectedRows?.[0]?.id || \"\";",
							"} catch (e) {",
							"    console.log(\"Error extracting fields:\", e);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    const expectedId = pm.environment.get(\"w_userid_t3\");",
							"",
							"    if (affectedId) {",
							"        pm.test(\"Affected user ID matches w_userid_t3\", function () {",
							"            pm.expect(affectedId).to.eql(expectedId);",
							"        });",
							"        console.log(\"Affected ID:\", affectedId);",
							"        console.log(\"Expected ID (w_userid_t3):\", expectedId);",
							"    } else {",
							"        console.log(\"No affectedId found.\");",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping ID test.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostInteractions {\n    postInteractions(getOnly: LIKE, postOrCommentId: \"{{postid}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            username\n            slug\n            img\n            isfollowed\n            isfollowing\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = {};",
							"try {",
							"    response = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let newLiquidityAfterLike = response?.data?.balance?.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity1\");",
							"let isDailyFreeLike = pm.environment.get(\"isDailyFreeLike\");",
							"let likeResponseCode = response?.data?.resolveActionPost?.ResponseCode || \"\";",
							"",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"",
							"if (isDailyFreeLike !== undefined) {",
							"    console.log(\"â© This was a Daily Free Like, skipping liquidity check.\");",
							"} else {",
							"    pm.test(\"Liquidity should decrease after liking\", function () {",
							"        pm.expect(newLiquidityAfterLike).to.be.below(oldLiquidity);",
							"    });",
							"",
							"    if (newLiquidityAfterLike !== undefined) {",
							"        pm.environment.set(\"liquidity1\", newLiquidityAfterLike);",
							"    }",
							"}",
							"",
							"pm.environment.unset(\"isDailyFreeLike\");"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Double like (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31501\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(postid:\"{{postid}}\" , action: LIKE) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let currentLiquidity = response.data.balance.currentliquidity;",
							"let previousLiquidity = pm.environment.get(\"liquidity1\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(previousLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should remain the same\", function () {",
							"    pm.expect(currentLiquidity).to.eql(previousLiquidity);",
							"});",
							"console.log(`Previous Liquidity: ${previousLiquidity}, Current Liquidity: ${currentLiquidity}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Dislike post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11504\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(postid:\"{{postid}}\" , action: DISLIKE) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Content engagement (dislike)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    const responseText = pm.response.text();",
							"    pm.expect(responseText.includes(\"11205\")).to.be.true;",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postInteractionResponse = {};",
							"try {",
							"    postInteractionResponse = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let interactionResponseCode = \"\";",
							"let affectedId = \"\";",
							"",
							"try {",
							"    interactionResponseCode = postInteractionResponse?.data?.postInteractions?.ResponseCode || \"\";",
							"    affectedId = postInteractionResponse?.data?.postInteractions?.affectedRows?.[0]?.id || \"\";",
							"} catch (e) {",
							"    console.log(\"Error extracting fields:\", e);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    const expectedId = pm.environment.get(\"w_userid_t3\");",
							"",
							"    if (affectedId) {",
							"        pm.test(\"Affected user ID matches w_userid_t3\", function () {",
							"            pm.expect(affectedId).to.eql(expectedId);",
							"        });",
							"        console.log(\"Affected ID:\", affectedId);",
							"        console.log(\"Expected ID (w_userid_t3):\", expectedId);",
							"    } else {",
							"        console.log(\"No affectedId found.\");",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping ID test.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostInteractions {\n    postInteractions(getOnly: DISLIKE, postOrCommentId: \"{{postid}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            username\n            slug\n            img\n            isfollowed\n            isfollowing\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let newLiquidity = response.data.balance.currentliquidity;",
							"let oldLiquidity = pm.environment.get(\"liquidity1\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(oldLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should decrease after spending\", function () {",
							"    pm.expect(newLiquidity).to.be.below(oldLiquidity);",
							"});",
							"pm.environment.set(\"liquidity1\", newLiquidity);",
							"console.log(`Old Liquidity: ${oldLiquidity}, New Liquidity: ${newLiquidity}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Transaction history",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"ResponseCode\":\"11215\"');",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"const json = pm.response.json();",
							"const rows = json?.data?.transactionHistory?.affectedRows ?? [];",
							"",
							"const currentOpIds = rows.map(tx => tx.operationid);",
							"",
							"let prevOpIds = pm.environment.get(\"operationid\");",
							"prevOpIds = prevOpIds ? JSON.parse(prevOpIds) : [];",
							"",
							"const duplicates = currentOpIds.filter(id => prevOpIds.includes(id));",
							"",
							"pm.test(\"No duplicate operationid from previous request\", () => {",
							"    pm.expect(duplicates.length, `Duplicate operationid found: ${duplicates}`).to.equal(0);",
							"});",
							"",
							"const allOpIds = Array.from(new Set([...prevOpIds, ...currentOpIds]));",
							"pm.environment.set(\"operationid\", JSON.stringify(allOpIds));",
							"",
							"pm.test(\"affectedRows is non-empty array\", () => {",
							"    pm.expect(rows).to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"const P2P_EXPECTED_TOKEN = Number(pm.environment.get(\"tokenamount\"));",
							"const TOLERANCE = 0.0001;",
							"",
							"function num(v) {",
							"    return Number(v);",
							"}",
							"",
							"function expectNotNull(value, path) {",
							"    pm.expect(",
							"        value !== null && value !== undefined && value !== \"\",",
							"        `${path} is null/empty`",
							"    ).to.be.true;",
							"}",
							"",
							"function expectPercent(actual, base, percent, path) {",
							"    const expected = +(base * percent / 100).toFixed(6);",
							"    pm.expect(",
							"        actual,",
							"        `${path} expected ${percent}% (${expected}), got ${actual}`",
							"    ).to.be.closeTo(expected, TOLERANCE);",
							"}",
							"",
							"rows.forEach((tx, i) => {",
							"    const p = `affectedRows[${i}]`;",
							"",
							"    pm.test(`${p} mandatory fields not null`, () => {",
							"        [",
							"            \"operationid\",",
							"            \"transactionCategory\",",
							"            \"transactiontype\",",
							"            \"tokenamount\",",
							"            \"netTokenAmount\",",
							"            \"createdat\"",
							"        ].forEach(f => expectNotNull(tx[f], `${p}.${f}`));",
							"",
							"        [\"sender\", \"recipient\"].forEach(role => {",
							"            Object.entries(tx[role]).forEach(([k, v]) => {",
							"                if (k !== \"updatedat\") {",
							"                    expectNotNull(v, `${p}.${role}.${k}`);",
							"                }",
							"            });",
							"        });",
							"",
							"        [\"total\", \"burn\", \"peer\"].forEach(f =>",
							"            expectNotNull(tx.fees[f], `${p}.fees.${f}`)",
							"        );",
							"    });",
							"",
							"    pm.test(`${p} fees calculation`, () => {",
							"        const base = Math.abs(num(tx.netTokenAmount));",
							"        const hasInviter = tx.fees.inviter !== null;",
							"",
							"        expectPercent(",
							"            num(tx.fees.total),",
							"            base,",
							"            hasInviter ? 4 : 3,",
							"            `${p}.fees.total`",
							"        );",
							"",
							"        expectPercent(num(tx.fees.burn), base, 1, `${p}.fees.burn`);",
							"        expectPercent(num(tx.fees.peer), base, 2, `${p}.fees.peer`);",
							"",
							"        if (hasInviter) {",
							"            expectPercent(",
							"                num(tx.fees.inviter),",
							"                base,",
							"                1,",
							"                `${p}.fees.inviter`",
							"            );",
							"        }",
							"    });",
							"",
							"    pm.test(`${p} tokenamount by transactionCategory`, () => {",
							"        const token = Math.abs(num(tx.tokenamount));",
							"",
							"        switch (tx.transactionCategory) {",
							"            case \"LIKE\":",
							"            case \"DISLIKE\":",
							"                pm.expect(token).to.equal(3);",
							"                break;",
							"",
							"            case \"COMMENT\":",
							"                pm.expect(token).to.equal(1);",
							"                break;",
							"",
							"            case \"AD_PINNED\":",
							"                pm.expect(",
							"                    token === 160 || token % 50 === 0,",
							"                    `${p}.AD_PINNED token invalid: ${token} (expected 160 or multiple of 50)`",
							"                ).to.be.true;",
							"                break;",
							"",
							"            case \"POST_CREATE\":",
							"                pm.expect(token).to.equal(20);",
							"                break;",
							"",
							"            case \"P2P_TRANSFER\":",
							"                pm.expect(token).to.equal(P2P_EXPECTED_TOKEN);",
							"                break;",
							"",
							"            default:",
							"                console.warn(`Unhandled category: ${tx.transactionCategory}`);",
							"        }",
							"    });",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query TransactionHistory {\n    transactionHistory(limit: 1) {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            operationid\n            transactionCategory\n            transactiontype\n            tokenamount\n            netTokenAmount\n            message\n            createdat\n            sender {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            recipient {\n                userid\n                img\n                username\n                slug\n                biography\n                visibilityStatus\n                isHiddenForUsers\n                hasActiveReports\n                updatedat\n            }\n            fees {\n                total\n                burn\n                peer\n                inviter\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Double dislike (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31502\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(postid:\"{{postid}}\" , action: DISLIKE) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let currentLiquidity = response.data.balance.currentliquidity;",
							"let previousLiquidity = pm.environment.get(\"liquidity1\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(previousLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should remain the same\", function () {",
							"    pm.expect(currentLiquidity).to.eql(previousLiquidity);",
							"});",
							"console.log(`Previous Liquidity: ${previousLiquidity}, Current Liquidity: ${currentLiquidity}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Share post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11507\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(\n        postid: \"{{postid}}\"\n        action: SHARE\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Double share post (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31504\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(\n        postid: \"{{postid}}\"\n        action: SHARE\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "View post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11506\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(\n        postid: \"{{postid}}\"\n        action: VIEW\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Content engagement (view)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    const responseText = pm.response.text();",
							"    pm.expect(responseText.includes(\"11205\")).to.be.true;",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postInteractionResponse = {};",
							"try {",
							"    postInteractionResponse = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let interactionResponseCode = \"\";",
							"let affectedId = \"\";",
							"",
							"try {",
							"    interactionResponseCode = postInteractionResponse?.data?.postInteractions?.ResponseCode || \"\";",
							"    affectedId = postInteractionResponse?.data?.postInteractions?.affectedRows?.[0]?.id || \"\";",
							"} catch (e) {",
							"    console.log(\"Error extracting fields:\", e);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    const expectedId = pm.environment.get(\"w_userid_t3\");",
							"",
							"    if (affectedId) {",
							"        pm.test(\"Affected user ID matches w_userid_t3\", function () {",
							"            pm.expect(affectedId).to.eql(expectedId);",
							"        });",
							"        console.log(\"Affected ID:\", affectedId);",
							"        console.log(\"Expected ID (w_userid_t3):\", expectedId);",
							"    } else {",
							"        console.log(\"No affectedId found.\");",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping ID test.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostInteractions {\n    postInteractions(getOnly: VIEW, postOrCommentId: \"{{postid}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            username\n            slug\n            img\n            isfollowed\n            isfollowing\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Double view post (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31505\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolveActionPost {\n    resolvePostAction(\n        postid: \"{{postid}}\"\n        action: VIEW\n    ) {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Save post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11512\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolvePostAction {\n    resolvePostAction(action: SAVE, postid: \"{{postid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Unsave post",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11511\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation ResolvePostAction {\n    resolvePostAction(action: SAVE, postid: \"{{postid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Like invalid commentid",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31601\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation LikeComment {\n    likeComment(commentid: \"{{uuid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Like comment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11603\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation LikeComment {\n    likeComment(commentid: \"{{commentid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Content engagement (comments likes)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    const responseText = pm.response.text();",
							"    pm.expect(responseText.includes(\"11205\")).to.be.true;",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let postInteractionResponse = {};",
							"try {",
							"    postInteractionResponse = pm.response.json();",
							"} catch (e) {",
							"    console.log(\"Failed to parse JSON:\", e);",
							"}",
							"",
							"let interactionResponseCode = \"\";",
							"let affectedId = \"\";",
							"",
							"try {",
							"    interactionResponseCode = postInteractionResponse?.data?.postInteractions?.ResponseCode || \"\";",
							"    affectedId = postInteractionResponse?.data?.postInteractions?.affectedRows?.[0]?.id || \"\";",
							"} catch (e) {",
							"    console.log(\"Error extracting fields:\", e);",
							"}",
							"",
							"if (!pm.response.text().includes(\"error\")) {",
							"    const expectedId = pm.environment.get(\"w_userid_t3\");",
							"",
							"    if (affectedId) {",
							"        pm.test(\"Affected user ID matches w_userid_t3\", function () {",
							"            pm.expect(affectedId).to.eql(expectedId);",
							"        });",
							"        console.log(\"Affected ID:\", affectedId);",
							"        console.log(\"Expected ID (w_userid_t3):\", expectedId);",
							"    } else {",
							"        console.log(\"No affectedId found.\");",
							"    }",
							"} else {",
							"    console.log(\"Error detected in response, skipping ID test.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query PostInteractions {\n    postInteractions(getOnly: COMMENTLIKE, postOrCommentId: \"{{commentid}}\") {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            id\n            username\n            slug\n            img\n            isfollowed\n            isfollowing\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Double like comment (fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31604\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation LikeComment {\n    likeComment(commentid: \"{{commentid}}\") {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Check current liquidity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"let currentLiquidity = response.data.balance.currentliquidity;",
							"let previousLiquidity = pm.environment.get(\"liquidity1\");",
							"pm.test(\"Previous liquidity exists\", function () {",
							"    pm.expect(previousLiquidity).to.be.a(\"number\");",
							"});",
							"pm.test(\"Liquidity should remain the same\", function () {",
							"    pm.expect(currentLiquidity).to.eql(previousLiquidity);",
							"});",
							"console.log(`Previous Liquidity: ${previousLiquidity}, Current Liquidity: ${currentLiquidity}`);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Balance {\n    balance {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        currentliquidity\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Fetchpayslog",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"21202\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query ListPaymentLogs {\n    listPaymentLogs(day: D0) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            from\n            token\n            userid\n            postid\n            action\n            numbers\n            createdat\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Login tester 2",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"10801\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"",
							"let response = pm.response.json();",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"accessToken\", response.data.login.accessToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"if (!pm.response.text().includes(\"error\")) {",
							"    pm.environment.set(\"refreshToken\", response.data.login.refreshToken);",
							"} else {",
							"    console.log(\"Error detected in response, environment variable not set.\");",
							"}",
							"let token = pm.environment.get(\"accessToken\");",
							"pm.test(\"Access token exists\", function () {",
							"    pm.expect(token).to.be.a(\"string\");",
							"});",
							"",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation {\n  login(email: \"{{w_email_t2}}\",\n    password: \"{{w_password_t2}}\"\n  ) {\n    meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n    accessToken\n    refreshToken\n  }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Gemster",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11207\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							"pm.test(\"d0 is 0\", function () {",
							"    const json = pm.response.json();",
							"    pm.expect(json?.data?.gemster?.affectedRows?.d0).to.eql(0);",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Gemster {\n    gemster {\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            d0\n            d1\n            d2\n            d3\n            d4\n            d5\n            w0\n            m0\n            y0\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Fetchwinslog",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11203\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "query Fetchwinslog {\n    listWinLogs(day: D0) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            from\n            token\n            userid\n            postid\n            action\n            numbers\n            createdat\n        }\n    }\n}",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Globalwins",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"11206\");",
							"});",
							"",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"success\"');",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation Globalwins {\n    globalwins {\n        status\n        RequestId\n        ResponseCode\n        ResponseMessage\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Gemsters",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// --- Parse once ---",
							"const json = pm.response.json();",
							"const gemsters = json?.data?.gemsters;",
							"const affected = gemsters?.affectedRows;",
							"const userStatus = Array.isArray(affected?.userStatus) ? affected.userStatus : [];",
							"",
							"// --- Helpers ---",
							"function toNum(x) { return Number(x) || 0; }",
							"function sum(arr, sel) { return arr.reduce((acc, it) => acc + toNum(sel(it)), 0); }",
							"function approxEqual(a, b, eps = 1e-6) { return Math.abs(toNum(a) - toNum(b)) <= eps; }",
							"",
							"// --- Totals ---",
							"const totalPercentage = sum(userStatus, u => u.percentage);",
							"const totalGems = sum(userStatus, u => u.gems);",
							"const totalTokens = sum(userStatus, u => u.tokens);",
							"",
							"// d0 source: env var `d0` > winStatus.totalGems > 0",
							"const d0Env = pm.environment.get(\"d0\");",
							"const d0FromEnv = d0Env !== undefined && d0Env !== null ? toNum(d0Env) : null;",
							"const d0FromPayload = toNum(affected?.winStatus?.totalGems);",
							"const d0 = d0FromEnv !== null ? d0FromEnv : d0FromPayload;",
							"",
							"// --- Assertions ---",
							"pm.test(\"Percentages sum to 100\", function () {",
							"  pm.expect(",
							"    approxEqual(totalPercentage, 100, 1e-6),",
							"    `sum(percentage)=${totalPercentage}`",
							"  ).to.be.true;",
							"});",
							"",
							"pm.test(\"Total gems equals d0\", function () {",
							"  pm.expect(",
							"    approxEqual(totalGems, d0, 1e-6),",
							"    `sum(gems)=${totalGems}, d0=${d0}`",
							"  ).to.be.true;",
							"});",
							"",
							"pm.test(\"Total tokens equals 5000\", function () {",
							"  pm.expect(",
							"    approxEqual(totalTokens, 5000, 1e-6),",
							"    `sum(tokens)=${totalTokens}`",
							"  ).to.be.true;",
							"});",
							"",
							"// --- Optional sanity checks ---",
							"pm.test(\"userStatus array present\", function () {",
							"  pm.expect(userStatus, \"userStatus missing/empty\").to.be.an(\"array\").that.is.not.empty;",
							"});",
							"",
							"// --- Diagnostics (Postman Console) ---",
							"console.log(\"Diagnostics:\", {",
							"  totalPercentage,",
							"  totalGems,",
							"  totalTokens,",
							"  d0_used: d0,",
							"  d0_source: d0FromEnv !== null ? \"env.d0\" : \"affected.winStatus.totalGems\",",
							"  userCount: userStatus.length",
							"});",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation Gemsters {\n    gemsters(day: D0) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            winStatus {\n                totalGems\n                gemsintoken\n                bestatigung\n            }\n            userStatus {\n                userid\n                gems\n                tokens\n                percentage\n                details {\n                    gemid\n                    userid\n                    postid\n                    fromid\n                    gems\n                    numbers\n                    whereby\n                    createdat\n                }\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		},
		{
			"name": "Double Gemsters(Fail)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"ResponseCode is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include(\"31204\");",
							"});",
							"pm.test(\"Status is correct\", function () {",
							"    pm.expect(pm.response.text()).to.include('\"status\":\"error');",
							"});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{accessToken}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "graphql",
					"graphql": {
						"query": "mutation Gemsters {\n    gemsters(day: D0) {\n        counter\n        meta {\n            status\n            RequestId\n            ResponseCode\n            ResponseMessage\n        }\n        affectedRows {\n            winStatus {\n                totalGems\n                gemsintoken\n                bestatigung\n            }\n            userStatus {\n                userid\n                gems\n                tokens\n                percentage\n                details {\n                    gemid\n                    userid\n                    postid\n                    fromid\n                    gems\n                    numbers\n                    whereby\n                    createdat\n                }\n            }\n        }\n    }\n}\n",
						"variables": ""
					}
				},
				"url": {
					"raw": "{{test-backend}}/graphql",
					"host": [
						"{{test-backend}}"
					],
					"path": [
						"graphql"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		}
	]
}